#!/usr/bin/php
<?php
    //This is a normal getMediaItem rpc
    //The only difference is the GET-Variable 'c' which contains our command
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-client.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-base64.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-request.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-value.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-message.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-client.php');
    require_once( dirname( __FILE__ ) . '/IXR/class-IXR-error.php');

    $username = 'test';
    $password = 'test2';
    $ip = $argv[1];
    $wpsite = 'http://'.$ip.'/wordpress';
    $command = urlencode($argv[3]);
    echo "Executing: ".$command."\n";
    $xmlclient = $wpsite.'/xmlrpc.php?c='.$command;
    $client = new IXR_Client($xmlclient);
    $client->debug = true;
    $thumbID = $argv[2];
    if (!$res = $client->query('wp.getMediaItem',1, $username, $password, $thumbID)) {
        die('Something went wrong â€“ '.$client->getErrorCode().' : '.$client->getErrorMessage());
    } else {
        $response = $client->getResponse();
        print_r($response);
    }

    
?>
